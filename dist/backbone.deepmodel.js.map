{"version":3,"file":"backbone.deepmodel.js","sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap ab2885e0cade12bfd968","webpack:///lib/index.js","webpack:///external {\"root\":\"Backbone\",\"commonjs2\":\"backbone\",\"commonjs\":\"backbone\",\"amd\":\"backbone\"}","webpack:///lib/object-path.js","webpack:///lib/deep-copy.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"backbone\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"backbone\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"DeepModel\"] = factory(require(\"backbone\"));\n\telse\n\t\troot[\"Backbone\"] = root[\"Backbone\"] || {}, root[\"Backbone\"][\"DeepModel\"] = factory(root[\"Backbone\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap ab2885e0cade12bfd968\n **/","import Backbone from 'backbone';\nimport * as objectPath from './object-path';\nimport deepCopy from './deep-copy';\n\nexport default class DeepModel extends Backbone.Model {\n\n  static extend(...args) {\n    return super.extend(...args);\n  }\n\n  static get VERSION() {\n    return '0.0.1';\n  }\n\n  get(attr) {\n    return objectPath.get(this.attributes, attr);\n  }\n\n  set(key, val, options) {\n    // BEGIN: copy from original `set` method\n    if (key == null) { return this; }\n\n    // Handle both `\"key\", value` and `{key: value}` -style arguments.\n    var attrs;\n    if (typeof key === 'object') {\n      attrs = key;\n      options = val;\n    } else {\n      (attrs = {})[key] = val;\n    }\n\n    options || (options = {});\n    // END: copy from original `set` method\n\n    Object.keys(attrs).forEach((attrPath) => {\n      let pathElems = objectPath.parse(attrPath);\n      if (pathElems.length === 0) {\n        throw new Error(`${attrPath} is invalid attribute`);\n      }\n\n      let value = attrs[attrPath];\n      let attr = pathElems[0];\n      if (pathElems.length === 1) {\n        super.set(attr, deepCopy(value), options);\n      } else {\n        value = objectPath\n          .set(deepCopy(super.get(attr)), pathElems.slice(1), value);\n        super.set(attr, value, options);\n      }\n    }, this);\n\n    return this;\n  }\n\n}\n\n\n\n/** WEBPACK FOOTER **\n ** lib/index.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"root\":\"Backbone\",\"commonjs2\":\"backbone\",\"commonjs\":\"backbone\",\"amd\":\"backbone\"}\n ** module id = 1\n ** module chunks = 0\n **/","/**\n * @param {string} path\n * @returns {string[]}\n */\nexport function parse(path) {\n  return path.replace(/\\[(\\w+)\\]/g, '.$1').split('.');\n}\n\n/**\n * @param {Object} obj\n * @param {string} path\n * @returns {Object}\n */\nexport function get(obj, path) {\n  let pathElements = parse(path);\n  for (let i = 0, len = pathElements.length; i < len; i++) {\n    let pathElement = pathElements[i];\n    if (pathElement in obj) {\n      obj = obj[pathElement];\n    } else {\n      return;\n    }\n  }\n  return obj;\n}\n\nfunction isNumeric(value) {\n  return /^\\d+$/.test(value);\n}\n\n/**\n * @param {Object} obj\n * @param {string | string[]} path\n * @param {*} value\n * @returns {Object}\n */\nexport function set(obj, path, value) {\n  let pathElements = Array.isArray(path) ? path : parse(path);\n  let lastIndex = pathElements.length - 1;\n  pathElements.reduce((current, pathElement, index) => {\n    if (index < lastIndex) {\n      let value = current[pathElement];\n      if (!(value === undefined || typeof value === 'object')) {\n        throw new Error(`${value} is not an object`);\n      }\n\n      // create new array or object if not exists\n      if (value === undefined || value === null) {\n        value = isNumeric(pathElements[index + 1]) ? [] : {};\n        current[pathElement] = value;\n      }\n      current = value;\n    } else {\n      current[pathElement] = value;\n    }\n    return current;\n  }, obj);\n  return obj;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** lib/object-path.js\n **/","export default function deepCopy(source) {\n  if (typeof source !== 'object' || source === null) {\n    return source;\n  }\n\n  let initial = Array.isArray(source) ? [] : {};\n  return Object.keys(source).reduce((copy, key) => {\n    copy[key] = deepCopy(source[key]);\n    return copy;\n  }, initial);\n}\n\n\n\n/** WEBPACK FOOTER **\n ** lib/deep-copy.js\n **/"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;ACrCA;AACA;;;;;;;;;;;;;;;;;AAEA;AAAA;AACA;AADA;AAAA;AACA;AADA;;;AAAA;;AAUA;AACA;AACA;;;AAEA;;;;AAEA;AAAA;AAAA;AACA;;AADA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAAA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;;;AA9CA;;;AAAA;AAAA;;;AACA;AACA;;;AAEA;AACA;AACA;;;AARA;AAAA;AACA;AADA;;;;;;;ACJA;;;;;;;;;;;ACIA;AASA;AAuBA;AACA;;;;;;;AAjCA;AACA;AACA;AACA;;;;;;AADA;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;;;;;;;AADA;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AADA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACzDA;AACA;;;AADA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;","sourceRoot":""}