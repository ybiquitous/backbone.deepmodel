{"version":3,"file":"backbone.deepmodel.js","sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap fc7f109354c487af4629","webpack:///lib/index.js","webpack:///external {\"root\":\"Backbone\",\"commonjs2\":\"backbone\",\"commonjs\":\"backbone\",\"amd\":\"backbone\"}","webpack:///lib/object-path.js","webpack:///lib/deep-copy.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"backbone\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"backbone\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"DeepModel\"] = factory(require(\"backbone\"));\n\telse\n\t\troot[\"Backbone\"] = root[\"Backbone\"] || {}, root[\"Backbone\"][\"DeepModel\"] = factory(root[\"Backbone\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap fc7f109354c487af4629\n **/","import Backbone from 'backbone';\nimport objectPath from './object-path';\nimport deepCopy from './deep-copy';\n\nconst DEFAULTS = Object.freeze({\n  pathSeparator: '.'\n});\n\nconst _defaults = Object.assign({}, DEFAULTS);\n\nexport default class DeepModel extends Backbone.Model {\n\n  static get VERSION() {\n    return '0.0.3';\n  }\n\n  static defaults(args = {}) {\n    Object.assign(_defaults, args === null ? DEFAULTS : args);\n  }\n\n  get(attr) {\n    objectPath.pathSeparator = _defaults.pathSeparator;\n    return objectPath.get(this.attributes, attr);\n  }\n\n  set(key, value, options) {\n    if (key == null) {\n      return this;\n    }\n\n    let attrs;\n    if (typeof key === 'object') {\n      attrs = key;\n      options = value;\n    } else {\n      attrs = {[key]: value};\n    }\n\n    objectPath.pathSeparator = _defaults.pathSeparator;\n    const newAttrs = Object.keys(attrs).reduce((newObj, path) => {\n      const paths = objectPath.parse(path);\n      if (paths.length === 1) {\n        newObj[path] = attrs[path];\n        return newObj;\n      }\n\n      const parentPath = paths.slice(0, -1);\n      const obj = objectPath.get(newObj, parentPath) ||\n                  objectPath.get(this.attributes, parentPath);\n      if (!obj) {\n        throw new Error(`\"${path}\" does not exist in ${JSON.stringify(this)}`);\n      }\n      objectPath.set(newObj, parentPath, deepCopy(obj));\n\n      return objectPath.set(newObj, paths, attrs[path]);\n    }, {});\n\n    return super.set(newAttrs, options);\n  }\n\n}\n\nDeepModel.extend = Backbone.Model.extend;\n\n\n\n/** WEBPACK FOOTER **\n ** lib/index.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"root\":\"Backbone\",\"commonjs2\":\"backbone\",\"commonjs\":\"backbone\",\"amd\":\"backbone\"}\n ** module id = 1\n ** module chunks = 0\n **/","function isObject(value) {\n  return value !== null && typeof value === 'object';\n}\n\nfunction isArrayIndex(value) {\n  const num = Number(value);\n  return num >= 0 && num % 1 === 0;\n}\n\nexport default {\n\n  pathSeparator: '.',\n\n  /**\n   * @param {string | string[]} path\n   * @returns {string[]}\n   *\n   * @example\n   * parse('a.b') //=> ['a', 'b']\n   */\n  parse(path) {\n    if (Array.isArray(path)) {\n      return path;\n    }\n    const sep = this.pathSeparator;\n    return path.replace(/\\[(\\w+)\\]/g, sep + '$1').split(sep);\n  },\n\n  /**\n   * @param {Object} obj\n   * @param {string | string[]} path\n   * @returns {?Object}\n   */\n  get(obj, path) {\n    const pathElements = this.parse(path);\n    for (let i = 0, len = pathElements.length; i < len; i++) {\n      const pathElement = pathElements[i];\n      if (pathElement in obj) {\n        obj = obj[pathElement];\n      } else {\n        return;\n      }\n    }\n    return obj;\n  },\n\n  /**\n   * @param {Object} obj\n   * @param {string | string[]} path\n   * @param {*} value\n   * @returns {Object}\n   */\n  set(obj, path, value) {\n    const pathElements = this.parse(path);\n    const lastIndex = pathElements.length - 1;\n    pathElements.reduce((current, pathElement, index) => {\n      if (index < lastIndex) {\n        let v = current[pathElement];\n        if (!isObject(v)) {\n          v = current[pathElement] =\n            (isArrayIndex(pathElements[index + 1]) ? [] : {});\n        }\n        current = v;\n      } else {\n        current[pathElement] = value;\n      }\n      return current;\n    }, obj);\n    return obj;\n  }\n\n};\n\n\n\n/** WEBPACK FOOTER **\n ** lib/object-path.js\n **/","export default function deepCopy(source) {\n  if (typeof source !== 'object' || source === null) {\n    return source;\n  }\n\n  let initial = Array.isArray(source) ? [] : {};\n  return Object.keys(source).reduce((copy, key) => {\n    copy[key] = deepCopy(source[key]);\n    return copy;\n  }, initial);\n}\n\n\n\n/** WEBPACK FOOTER **\n ** lib/deep-copy.js\n **/"],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AADA;AAAA;AACA;AADA;;;AAAA;;AAUA;AACA;AACA;AACA;;;AAEA;;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AA1CA;AAAA;AACA;AAAA;AACA;;;AANA;AACA;AACA;;;AAJA;AAAA;AACA;AADA;AACA;AAmDA;;;;;;;AC9DA;;;;;;;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;;;;;;;;ACvEA;AACA;;;AADA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;","sourceRoot":""}